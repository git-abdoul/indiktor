<ui:composition template="/WEB-INF/template/mainTemplate.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
             	xmlns:ui="http://java.sun.com/jsf/facelets"
             	xmlns:f="http://java.sun.com/jsf/core"
             	xmlns:ice="http://www.icesoft.com/icefaces/component"
             	xmlns:h="http://java.sun.com/jsf/html">
<ui:param name="pageTitle" value="DashBoard Configuration" />
<ui:define name="content">	

<ice:panelGrid>
<ice:panelGrid>
<ice:form>
	<table id="pageDashBoardManager">
		<tr>
			<td>
				<table id="topMenuBar">
					<tr>
						<td class="topMenuBarLeft2">		
							<div class="topMenuBarLeftAnalysis">
								<ice:commandButton image="/images/IndiKtor2.0/AdminPanel/Dashboard/DashboardManagerON.png"
								   				   title="Dashboard Manager"
								   				   value="Dashboard Manager"
												   actionListener="#{dashboardMainConfigBean.initUpdate}" 
									    	  	   action="#{dashboardMainConfigBean.action}"/>
							</div>
						</td>
						<td class="topMenuBarRight">
							<table>
								<tr>
									<!-- <td>
										<ice:commandButton styleClass="topMenuBarRightIcons"
														   actionListener="#{dashboardMainConfigBean.openFilterPopup}"
														   image="/images/IndiKtor2.0/Buttons/filter.png"
													   	   title="Filter"/>
									</td> -->
									<td>
										<ice:commandButton styleClass="topMenuBarRightIcons"
														   image="/images/IndiKtor2.0/Buttons/add.png"
													   	   title="Add new dashboard"
													   	   value="Create new Dashboard"
														   actionListener="#{dashboardMainConfigBean.addDashboard}"/>
									</td>
									<!-- 
									<td>
										<ice:commandButton styleClass="topMenuBarRightIcons"
														   image="/images/IndiKtor2.0/Buttons/edit.png"
														   title="Edit selected dashboard"
														   actionListener="#{dashboardMainConfigBean.editDashboard}"
														   action="#{dashboardMainConfigBean.action}">
										</ice:commandButton>
									</td>
									 -->
									<td>
										<ice:commandButton panelConfirmation="#{dashboardMainConfigBean.dashboardsSelected == 0 ? false : 'deleteDashboardPanel'}"
														   styleClass="topMenuBarRightIcons"
														   image="/images/IndiKtor2.0/Buttons/delete.png"
														   title="Delete selected dashboards"
														   actionListener="#{dashboardMainConfigBean.deleteSelectedDashBoards}"
														   rendered="#{dashboardMainConfigBean.dashboardsSelected != 0}">
										</ice:commandButton>
										<ice:panelConfirmation 	id="deleteDashboardPanel"
																message="#{dashboardMainConfigBean.deleteMessage}"
																type="normal"
																acceptLabel="Delete"
																rendered="true"
																autoCentre="true"/>
									</td>
									<td>
										<ice:commandButton styleClass="topMenuBarRightIcons" 
														   value="Return to administration panel"
														   image="/images/IndiKtor2.0/Buttons/cancel.png"
													   	   title="Return to administration panel"
													   	   actionListener="#{adminBean.init}"
													   	   action="#{adminBean.action}"/>
									</td>
									<td>
										<ice:commandButton styleClass="topMenuBarRightIcons"
														   image="/images/IndiKtor2.0/Buttons/help.png"
													   	   title="Help"/>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table>
			</td>
		</tr>
		<tr>
			<td>
				<table id="pageContent">
					<tr>
						<td class="contentFullPanelDashboardManager">
							<table>	
								<tr>
									<td>
										<ice:outputText style="float: right; font-weight: bold; margin-top: 2px; margin-right: 5px;" value=" : Master Dashboard"/>
										<ice:graphicImage style="float: right;" url="/images/IndiKtor2.0/Buttons/mainDashboard.png"/>
									</td>
								</tr>
								<tr height="30px"><td></td></tr>
								<tr>
									<td>
							   			<ice:panelGroup style="text-align:center;">
											<ice:dataPaginator id="DashboardTableScroll_1" for="DashboardTable"
												rowsCountVar="rowsCount"
												displayedRowsCountVar="displayedRowsCountVar"
												firstRowIndexVar="firstRowIndex"
												lastRowIndexVar="lastRowIndex" pageCountVar="pageCount"
												pageIndexVar="pageIndex">
												<ice:outputFormat value="{0} Dashboards,  displaying {1} Dashboards,  from {2} to {3}. Page {4} / {5}."
																  style="font-weight: bold;"
																  styleClass="standard">
													<f:param value="#{rowsCount}" />
													<f:param value="#{displayedRowsCountVar}" />
													<f:param value="#{firstRowIndex}" />
													<f:param value="#{lastRowIndex}" />
													<f:param value="#{pageIndex}" />
													<f:param value="#{pageCount}" />
												</ice:outputFormat>
											</ice:dataPaginator>
										</ice:panelGroup>
									</td>
								</tr>
								<tr height="10px"><td></td></tr>
								<tr>
									<td align="center">
								    	<ice:panelGroup>
									    	<ice:dataTable 	id="DashboardTable"
									    					var="item"
								                      		value="#{dashboardMainConfigBean.dashboards}"
								                      		columnClasses="tableCol"
								                      		sortColumn="#{dashboardMainConfigBean.sortColumnName}"	
														    sortAscending="#{dashboardMainConfigBean.ascending}"
								                      		columnWidths="20, 345, 345, 345, 40"
								                      		rows="#{dashboardMainConfigBean.rowsByPage}">	
												<ice:column>													
													<f:facet name="header">
												       	<ice:selectBooleanCheckbox value="#{dashboardMainConfigBean.selectAll}" 
												       							   valueChangeListener="#{dashboardMainConfigBean.handleSelectAllDashboards}"	
												       							   partialSubmit="true"
												       							   style="text-align: center;"/>
													</f:facet>
											       	<ice:selectBooleanCheckbox value="#{item.selected}" 
											       							   valueChangeListener="#{dashboardMainConfigBean.handleSelectedDashboard}"	
											       							   partialSubmit="true"
											       							   style="text-align: center;"
											       							   rendered="#{!item.masterDashboards}">
											       		<f:attribute name="Dashboard" value="#{item}"/> 							   
											       	</ice:selectBooleanCheckbox>
											       	<ice:graphicImage url="/images/IndiKtor2.0/Buttons/mainDashboard.png"
											       					  rendered="#{item.masterDashboards}"
											       					  style="margin-left: 3px;"/>
												</ice:column>
								                <ice:column>
									                <!-- <ice:rowSelector
									                		value="#{item.selected}"
									                        selectionListener="#{dashboardMainConfigBean.rowSelectionListener}"
									                        preStyleOnSelection="true"
									                        selectedClass="tableRowSelSelected"
															mouseOverClass="tableRowSelMouseOver"
															selectedMouseOverClass="tableRowSelSelectedMouseOver"
															enhancedMultiple="true" 
											               	styleClass="iceRowSel-Dis"/> -->
									                <f:facet name="header">
									                	<ice:commandSortHeader columnName="#{dashboardMainConfigBean.envColumnName}" arrow="true" >
									                    	<ice:outputText value="#{dashboardMainConfigBean.envColumnName}"/>
									                    </ice:commandSortHeader>
									                </f:facet>
									                <ice:outputText style="text-align: left;" value="#{item.env}"/>
									            </ice:column>		
									            <ice:column>
									                <f:facet name="header">
									                	<ice:commandSortHeader columnName="#{dashboardMainConfigBean.typeColumnName}" arrow="true" >
									                    	<ice:outputText value="#{dashboardMainConfigBean.typeColumnName}"/>
									                    </ice:commandSortHeader>
									                </f:facet>
									                <ice:outputText style="text-align: left;" value="#{item.type}"/>
									            </ice:column>
									            <ice:column>
									                <f:facet name="header">
										                <ice:commandSortHeader columnName="#{dashboardMainConfigBean.titleColumnName}" arrow="true" >
										                    <ice:outputText value="#{dashboardMainConfigBean.titleColumnName}"/>
										                </ice:commandSortHeader>
									                </f:facet>
									                <ice:outputText style="text-align: left;" value="#{item.title}"/>
									            </ice:column>	
												<ice:column>
													<f:facet name="header">
													</f:facet>	
													<ice:commandButton actionListener="#{dashboardMainConfigBean.editDashboard}"
																	   image="/images/IndiKtor2.0/Buttons/editSmall.png"
																	   title="Edit this dashboard"
																	   action="#{dashboardMainConfigBean.action}">
														<f:attribute name="Dashboard" value="#{item}"/>
													</ice:commandButton>
													<ice:commandButton panelConfirmation="deleteNoSelectionConfirmPanel"
																	   image="/images/IndiKtor2.0/Buttons/deleteSmall.png"
																	   actionListener="#{dashboardMainConfigBean.deleteDashBoard}"
																	   title="Delete this dashboard"
																   	   style="margin-left: 10px;"
																   	   rendered="#{!item.masterDashboards}">
														<f:attribute name="Dashboard" value="#{item}"/>	
													</ice:commandButton>
															
													<ice:panelConfirmation 	id="deleteNoSelectionConfirmPanel"
																			message="Are you sure to delete this dashboard : #{item.env} > #{item.type} > #{item.title}"
																			type="normal"
																			acceptLabel="Delete"
																			rendered="true"
																			autoCentre="true"/>							
												</ice:column>					       
									        </ice:dataTable>
								    	</ice:panelGroup>
								    	<ice:panelGroup style="float:center;" visible="#{dashboardMainConfigBean.paginationVisible}">
											<center>
												<ice:dataPaginator id="DashboardTableScroll_2" for="DashboardTable"
													fastStep="3" paginator="true" paginatorMaxPages="4" actionListener="#{dashboardMainConfigBean.pageChangeListener}">
													<f:facet name="first">
														<ice:graphicImage id="firstpage_1"
															url="#{styleBean.imageDirectory}arrow-first.gif"
															style="border:none;"
															title="#{msgs['page.dataScrolling.firstpage']}" />
													</f:facet>
													<f:facet name="last">
														<ice:graphicImage id="lastpage_1"
															url="#{styleBean.imageDirectory}arrow-last.gif"
															style="border:none;"
															title="#{msgs['page.dataScrolling.lastpage']}" />
													</f:facet>
													<f:facet name="previous">
														<ice:graphicImage id="previouspage_1"
															url="#{styleBean.imageDirectory}arrow-previous.gif"
															style="border:none;"
															title="#{msgs['page.dataScrolling.previouspage']}" />
													</f:facet>
													<f:facet name="next">
														<ice:graphicImage id="nextpage_1"
															url="#{styleBean.imageDirectory}arrow-next.gif"
															style="border:none;"
															title="#{msgs['page.dataScrolling.nextpage']}" />
													</f:facet>
													<f:facet name="fastforward">
														<ice:graphicImage id="fastforward_1"
															url="#{styleBean.imageDirectory}arrow-ff.gif"
															style="border:none;"
															title="#{msgs['page.dataScrolling.fastforward']}" />
													</f:facet>
													<f:facet name="fastrewind">
														<ice:graphicImage id="fastrewind_1"
															url="#{styleBean.imageDirectory}arrow-fr.gif"
															style="border:none;"
															title="#{msgs['page.dataScrolling.fastbackward']}" />
													</f:facet>
												</ice:dataPaginator>
											</center>
										</ice:panelGroup>
									</td>
								</tr>
							</table>
						</td>
					</tr>
				</table> 	
			</td>
		</tr>
	</table>
	
	<ice:panelPopup draggable="false" modal="true" autoCentre="true" rendered="#{dashboardMainConfigBean.rendererNewDashboard}">
	    <f:facet name="header">
	    	<ice:panelGroup style="height: 25px;">
		       	<table width="100%">
		       		<tr>
		       			<td><ice:outputText style="float: left;" value="Add new dashboard"/></td>
		       			<td><ice:commandButton style="float: right;" 
		       								   actionListener="#{dashboardMainConfigBean.closeNewDashboardPopup}"
		       								   image="/images/i/cal_off.gif"
		       								   alt="Close"/>
		       				<ice:commandButton style="float: right;" 
											   image="/images/IndiKtor2.0/Buttons/saveSmall.png"
										   	   title="Save"
										   	   value="Save"
										   	   styleClass="iconPopup"
										   	   actionListener="#{dashboardMainConfigBean.createNewDashBoard}">
							</ice:commandButton>
						</td>
		       		</tr>
		       	</table> 
		    </ice:panelGroup>
	    </f:facet>
	    <f:facet name="body">
			<ice:panelGrid columns="1">
				<ice:panelGroup style="border: 1px solid #336699; text-align: center;">
					<ice:outputLabel value="Environment" style="font-size: 10px;"/>
					<ice:panelGrid columns="2">
						<ice:outputLabel value="Select: " style="font-size: 10px; font-weight: bold"/>
						<ice:selectOneMenu value="#{dashboardMainConfigBean.navItem.environment}" style="width: 200px" 
										   valueChangeListener="#{dashboardMainConfigBean.navItem.onChangeEnvironment}"
										   partialSubmit="true">
							<f:selectItems value="#{dashboardMainConfigBean.navItem.environmentItems}"/>
						</ice:selectOneMenu>	
						<ice:outputLabel value="New: " style="font-size: 10px; font-weight: bold"/>
						<ice:inputText value="#{dashboardMainConfigBean.newEnv}" style="#{dashboardMainConfigBean.newEnvStyle}"/>
						<ice:outputLabel value="" rendered="#{dashboardMainConfigBean.newEnvWrongFormat}"/>
						<ice:outputLabel value="Wrong format, fields must be alphanumerical characters"
										 style="color: red; font-size: 10px;"
			 							 rendered="#{dashboardMainConfigBean.newEnvWrongFormat}"/>
					</ice:panelGrid>
				</ice:panelGroup>
				<ice:panelGroup style="border: 1px solid #336699; text-align: center;">
					<ice:outputLabel value="Type" style="font-size: 10px;"/>
					<ice:panelGrid columns="2">
						<ice:outputLabel value="Select: " style="font-size: 10px; font-weight: bold"/>
						<ice:selectOneMenu value="#{dashboardMainConfigBean.navItem.type}" style="width: 200px" 
										   valueChangeListener="#{dashboardMainConfigBean.navItem.onChangeType}"
										   partialSubmit="true">		   
							<f:selectItems value="#{dashboardMainConfigBean.navItem.typeItems}"/>
						</ice:selectOneMenu>	
						<ice:outputLabel value="New: " style="font-size: 10px; font-weight: bold"/>
						<ice:inputText value="#{dashboardMainConfigBean.newType}" style="#{dashboardMainConfigBean.newTypeStyle}"/>
						<ice:outputLabel value="" rendered="#{dashboardMainConfigBean.newTypeWrongFormat}"/>
						<ice:outputLabel value="Wrong format, fields must be alphanumerical characters"
										 style="color: red; font-size: 10px;"
			 							 rendered="#{dashboardMainConfigBean.newTypeWrongFormat}"/>
					</ice:panelGrid>
				</ice:panelGroup>
				<ice:panelGroup style="border: 1px solid #336699; text-align: center;">
					<ice:outputLabel value="Title" style="font-size: 10px;"/>
					<ice:panelGrid columns="2">
						<ice:outputLabel value="New: " style="font-size: 10px; font-weight: bold; padding-right: 8px;"/>
						<ice:inputText value="#{dashboardMainConfigBean.newTitle}" style="#{dashboardMainConfigBean.newTitleStyle}"/>
						<ice:outputLabel value="" rendered="#{dashboardMainConfigBean.newTitleMandatory}"/>
						<ice:outputLabel value="Mandatory" style="color: red; font-size: 10px;"
			 							 rendered="#{dashboardMainConfigBean.newTitleMandatory}"/>
						<ice:outputLabel value="" rendered="#{dashboardMainConfigBean.newTitleAlreadyExists}"/>
						<ice:outputLabel value="This dashboard already exist !" style="color: red; font-size: 10px;"
			 							 rendered="#{dashboardMainConfigBean.newTitleAlreadyExists}"/>
						<ice:outputLabel value="" rendered="#{dashboardMainConfigBean.newTitleAlreadyExists}"/>
						<ice:outputLabel value="Please, choose another title." style="color: red; font-size: 10px;"
			 							 rendered="#{dashboardMainConfigBean.newTitleAlreadyExists}"/>
						<ice:outputLabel value="" rendered="#{dashboardMainConfigBean.newTitleWrongFormat}"/>
						<ice:outputLabel value="Wrong format, it must be alphanumerical characters"
										 style="color: red; font-size: 10px;"
			 							 rendered="#{dashboardMainConfigBean.newTitleWrongFormat}"/>
						<ice:outputLabel value="" rendered="#{dashboardMainConfigBean.newTitleTooLong}"/>
						<ice:outputLabel value="The name of a dashboard cannot have more than 40 characters, please choose another title"
										 style="color: red; font-size: 10px;"
			 							 rendered="#{dashboardMainConfigBean.newTitleTooLong}"/>
					</ice:panelGrid>
				</ice:panelGroup>
				
				<!-- 
				<table border="1px" bordercolor="#FFFFFF" width="100%" cellspacing="10px">
						<tr bordercolor="#336699">
							<td align="center">
								<ice:outputLabel value="Environment " style="font-size: 10px; font-weight: bold"/>
								<HR/>
								<ice:panelGrid columns="2">
									<ice:outputLabel value="Select: " style="font-size: 10px; font-weight: bold"/>
									<ice:selectOneMenu value="#{dashboardMainConfigBean.navItem.environment}" style="width: 200px" 
													   valueChangeListener="#{dashboardMainConfigBean.navItem.onChangeEnvironment}"
													   partialSubmit="true">
										<f:selectItems value="#{dashboardMainConfigBean.navItem.environmentItems}"/>
									</ice:selectOneMenu>	
									<ice:outputLabel value="New: " style="font-size: 10px; font-weight: bold"/>
									<ice:inputText value="#{dashboardMainConfigBean.newEnv}" style="width: 200px"/>	
								</ice:panelGrid>
							</td>
						</tr>
						<tr bordercolor="#336699">
							<td align="center">
								<ice:outputLabel value="Type " style="font-size: 10px; font-weight: bold"/>
								<HR/>
								<ice:panelGrid columns="2">
									<ice:outputLabel value="Select: " style="font-size: 10px; font-weight: bold"/>
									<ice:selectOneMenu value="#{dashboardMainConfigBean.navItem.type}" style="width: 200px" 
													   valueChangeListener="#{dashboardMainConfigBean.navItem.onChangeType}"
													   partialSubmit="true">		   
										<f:selectItems value="#{dashboardMainConfigBean.navItem.typeItems}"/>
									</ice:selectOneMenu>	
									<ice:outputLabel value="New: " style="font-size: 10px; font-weight: bold"/>
									<ice:inputText value="#{dashboardMainConfigBean.newType}" style="width: 200px"/>	
								</ice:panelGrid>
							</td>
						</tr>
						<tr bordercolor="#336699">
							<td align="center">
								<ice:outputLabel value="Title " style="font-size: 10px; font-weight: bold"/>
								<HR/>
								<ice:panelGrid columns="2">
									<ice:outputLabel value="New: " style="font-size: 10px; font-weight: bold"/>
									<ice:inputText value="#{dashboardMainConfigBean.newTitle}" style="width: 200px"/>	
								</ice:panelGrid>
							</td>
						</tr>
				</table>
				 -->
			</ice:panelGrid>
	    </f:facet>
	</ice:panelPopup>
	
	<!-- <ice:panelPopup draggable="false" modal="true" autoCentre="true" rendered="#{dashboardMainConfigBean.rendererFilter}">
	    <f:facet name="header">
	    	<ice:panelGroup style="height: 20px;">
		       	<table width="100%">
		       		<tr>
		       			<td><ice:outputText style="float: left;" value="Filter"/></td>
		       			<td><ice:commandButton style="float: right;" 
		       								   actionListener="#{dashboardMainConfigBean.closeFilterPopup}"
		       								   image="/images/i/cal_off.gif"
		       								   alt="Close"/>
						</td>
		       		</tr>
		       	</table> 
		    </ice:panelGroup>
	    </f:facet>
	    <f:facet name="body">
			<table>
				<tr>
					<td align="center">					    
						<ice:outputLabel value="Environment"/>
					</td>
				</tr>
				<tr>
					<td align="center">
						<ice:selectOneMenu value="#{dashboardMainConfigBean.dashboards.env}"
										   valueChangeListener="#{dashboardMainConfigBean.onChangeDashboardEnv}"
									       partialSubmit="true">
							<f:selectItems value="#{dashboardMainConfigBean.dashBoardEnvItems}"/>
						</ice:selectOneMenu>
					</td>
				</tr>
			</table>
	    </f:facet>
	</ice:panelPopup> -->
			
</ice:form>
<ui:include src="/jsp/util/errorMessage.xhtml"/>
</ice:panelGrid>
</ice:panelGrid>
</ui:define>
</ui:composition>