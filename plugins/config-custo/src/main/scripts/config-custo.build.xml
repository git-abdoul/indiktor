<project>

  <target name="windows">
    <filter filtersfile="../../conf/${env}.properties"/>	
		
	<path id="logs.path">
      <pathelement location="../../logs/${name}.log"/>
    </path>
	<!-- unix necessary to avoid \ in logs path, it's not a bug -->
	<pathconvert targetos="unix" property="logsPath" refid="logs.path"/>
		
	<path id="staticDomainModel.path">
      <pathelement location="../monitor-server/staticData/staticDomainModel.xml"/>
    </path>
	<pathconvert targetos="windows" property="staticDomainModelPath" refid="staticDomainModel.path"/>	

	<path id="metricDomainConfig.path">
      <pathelement location="../monitor-server/staticData/metricDomainConfig.xml"/>
    </path>
	<pathconvert targetos="windows" property="metricDomainConfigPath" refid="metricDomainConfig.path"/>
		
	<path id="persistencyContext.path">
      <pathelement location="../persistency/conf/local/persistencyContext.xml"/>
    </path>
	<pathconvert targetos="windows" property="persistencyContextPath" refid="persistencyContext.path"/>				
	
	<path id="smtp.mib.path">
      <pathelement location="src/main/resources/mibs/RFC1213-MIB"/>
    </path>
	<pathconvert targetos="windows" property="smtpMibPath" refid="smtp.mib.path"/>	
	
	<path id="dashboardConfig.path">
      <pathelement location="../../conf/dashboard"/>
    </path>
	<pathconvert targetos="windows" property="dashboardConfigPath" refid="dashboardConfig.path"/>	
	
	<property name="localConfDir" value="conf/local/"/>	
	<delete dir="${localConfDir}"/>
	<copy toDir="${localConfDir}" filtering="true">
		<fileset dir="conf/"/>
		<filterset>
			<filter token="MIB_PATH" value="${smtpMibPath}"/>
			<filter token="VERSION" value="${version}"/>
			<filter token="LOGS" value="${logsPath}"/>
			<filter token="STATIC_MODEL_MODEL" value="${staticDomainModelPath}"/>
			<filter token="METRIC_DOMAIN_CONFIG" value="${metricDomainConfigPath}"/>
			<filter token="PERSISTENCY_CONTEXT" value="${persistencyContextPath}"/>
			<filter token="DASHBOARD_CONFIG" value="${dashboardConfigPath}"/>
		</filterset>
	</copy>
  </target>
  
  <target name="unix">
    <filter filtersfile="../../conf/${env}.properties"/>	
		
	<path id="logs.path">
      <pathelement location="../../logs/${name}.log"/>
    </path>
	<pathconvert targetos="unix" property="logsPath" refid="logs.path"/>
		
	<path id="staticDomainModel.path">
      <pathelement location="../monitor-server/staticData/staticDomainModel.xml"/>
    </path>
	<pathconvert targetos="unix" property="staticDomainModelPath" refid="staticDomainModel.path"/>	

	<path id="metricDomainConfig.path">
      <pathelement location="../monitor-server/staticData/metricDomainConfig.xml"/>
    </path>
	<pathconvert targetos="unix" property="metricDomainConfigPath" refid="metricDomainConfig.path"/>
		
	<path id="persistencyContext.path">
      <pathelement location="../persistency/conf/local/persistencyContext.xml"/>
    </path>
	<pathconvert targetos="unix" property="persistencyContextPath" refid="persistencyContext.path"/>				
	
	<path id="smtp.mib.path">
      <pathelement location="src/main/resources/mibs/RFC1213-MIB"/>
    </path>
	<pathconvert targetos="unix" property="smtpMibPath" refid="smtp.mib.path"/>	
	
	<path id="dashboardConfig.path">
      <pathelement location="../../conf/dashboard"/>
    </path>
	<pathconvert targetos="unix" property="dashboardConfigPath" refid="dashboardConfig.path"/>	
	
	<property name="localConfDir" value="conf/local/"/>	
	<delete dir="${localConfDir}"/>
	<copy toDir="${localConfDir}" filtering="true">
		<fileset dir="conf/"/>
		<filterset>
			<filter token="MIB_PATH" value="${smtpMibPath}"/>
			<filter token="VERSION" value="${version}"/>
			<filter token="LOGS" value="${logsPath}"/>
			<filter token="STATIC_MODEL_MODEL" value="${staticDomainModelPath}"/>
			<filter token="METRIC_DOMAIN_CONFIG" value="${metricDomainConfigPath}"/>
			<filter token="PERSISTENCY_CONTEXT" value="${persistencyContextPath}"/>
			<filter token="DASHBOARD_CONFIG" value="${dashboardConfigPath}"/>
		</filterset>
	</copy>
  </target>  

</project>