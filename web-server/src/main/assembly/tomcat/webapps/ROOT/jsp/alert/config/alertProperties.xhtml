<f:subview id="alertProperties" 
		xmlns:h="http://java.sun.com/jsf/html"
 	    xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:ice="http://www.icesoft.com/icefaces/component">

<ice:panelTabSet> 
	<ice:panelTab id="tab1">
		<f:facet name="label">
			<ice:outputText value="Properties" style="#{alertCenterBean.tabPropertiesStyle}"/>
		</f:facet>
		<ice:panelGroup scrollHeight="530px" style="width: 838px; height: 500px; vertical-align: top; text-align: center;">
			<ice:panelGrid columns="1">
				<ice:panelGrid columns="2" style="width: 400px;">
					<ice:outputLabel value="Alert Activated"/>
					<ice:panelGrid columns="3">
						<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.alertDefinition.enable}" partialSubmit="true"/>
						<ice:outputLabel value="NOT ACTIVATED ! Save Anyway ?" style="color: red;"
										 rendered="#{alertCenterBean.saveNotActivated}"/>
						<ice:commandButton style="float: right;" 
	       								   styleClass="iconPopup" 
										   image="/images/IndiKtor2.0/Buttons/saveSmall.png"
									   	   title="Save anyway"
									   	   value="Save anyway"
										   actionListener="#{alertCenterBean.saveAnyway}"
										   rendered="#{alertCenterBean.saveNotActivated}"/>
					</ice:panelGrid>
					<ice:outputLabel value="Environment"/>
					<ice:outputText value="#{alertDefinitionModificationBean.logicalEnv.name}"
									rendered="#{alertDefinitionModificationBean.alertDefinition.id > 0}"
									style="#{alertCenterBean.envStyle2}"/>
					<ice:selectOneMenu value="#{alertDefinitionModificationBean.logicalEnvSelectionBean.logicalEnvId}"
									   valueChangeListener="#{alertDefinitionModificationBean.logicalEnvSelectionBean.onChangeLogicalEnv}"
									   partialSubmit="true"
									   rendered="#{alertDefinitionModificationBean.alertDefinition.id == 0}"
									   style="#{alertCenterBean.envStyle}">
						<f:selectItems value="#{alertDefinitionModificationBean.logicalEnvSelectionBean.logicalEnvItems}"/>
					</ice:selectOneMenu>
					
					
					<ice:outputLabel value="" rendered="#{alertCenterBean.coupleEnvNameExist}"/>
   					<ice:outputLabel value="Couple Env/Context already exists" style="color: red; font-size: 10px;"
   							  		 rendered="#{alertCenterBean.coupleEnvNameExist}"/>
					
					<ice:outputLabel value="Name"/>
					<ice:inputText value="#{alertDefinitionModificationBean.alertDefinition.name}"
								   style="#{alertCenterBean.nameStyle}"/>
					<ice:outputLabel value="" rendered="#{alertCenterBean.nameMandatory}"/>
   					<ice:outputLabel value="Mandatory" style="color: red; font-size: 10px;"
   							  		 rendered="#{alertCenterBean.nameMandatory}"/>
											
					<ice:outputLabel value="Description"/>
					<ice:inputTextarea value="#{alertDefinitionModificationBean.alertDefinition.description}"
									   rows="4" style="width: 275px;"/>
					
					<ice:outputLabel value="How to URL" title="Enter a link to a page describing the alert"/>
					<ice:inputText value="#{alertDefinitionModificationBean.alertDefinition.howTo}" style="width: 275px;"/>	
											
					<ice:outputLabel value="Group"/>
					<ice:selectOneMenu value="#{alertDefinitionModificationBean.group}"
								   	   valueChangeListener="#{alertDefinitionModificationBean.onChangeGroup}"
								       partialSubmit="true"
									   style="width: 275px;">
						<f:selectItems value="#{alertDefinitionModificationBean.groupItems}"/>
					</ice:selectOneMenu>
					
					<ice:outputLabel value="Domain"/>
					<ice:selectOneMenu value="#{alertDefinitionModificationBean.domain}"
								  	   valueChangeListener="#{alertDefinitionModificationBean.onChangeDomain}"
								       partialSubmit="true"
									   style="width: 275px;">
						<f:selectItems value="#{alertDefinitionModificationBean.domainItems}"/>
					</ice:selectOneMenu>
					
					<ice:outputLabel value="Sub-Domain"/>
					<ice:selectOneMenu value="#{alertDefinitionModificationBean.subDomain}"
								   	   partialSubmit="true"
									   style="width: 275px;">
						<f:selectItems value="#{alertDefinitionModificationBean.subdomainItems}"/>
					</ice:selectOneMenu>
					
					<ice:outputLabel value="Creation Date" rendered="#{alertDefinitionModificationBean.dateRenderer}"/>
					<ice:outputText value="#{alertDefinitionModificationBean.alertDefinition.creationDate}"
									rendered="#{alertDefinitionModificationBean.dateRenderer}">
						<f:convertDateTime pattern="dd/MM/yyyy H:mm:ss" type="date" />
					</ice:outputText>
					
					<ice:outputLabel value="Last Modified Date" rendered="#{alertDefinitionModificationBean.dateRenderer}"/>
					<ice:outputText value="#{alertDefinitionModificationBean.alertDefinition.lastUpdateDate}"
									rendered="#{alertDefinitionModificationBean.dateRenderer}">
						<f:convertDateTime pattern="dd/MM/yyyy H:mm:ss" type="date" />
					</ice:outputText>
				</ice:panelGrid>
				
				<HR/>
				
				<ice:panelGrid columns="2">
					<ice:outputLabel value="Validity :"/>
					<ice:outputLabel value="Time Slot :"/>
					<ice:panelGrid columns="1" style="border: 1px solid #336699; width: 500px; height: 145px;">
						<ice:panelGrid columns="2">
							<ice:panelGroup>
								<ice:panelGrid columns="5">
									<ice:outputLabel value="Start: " style="font-size: 10px; font-weight: bold"/>
									<!-- <ice:inputText value="#{alertDefinitionModificationBean.hourStart}" style="width: 30px;"/> -->
									<ice:selectOneMenu value="#{alertDefinitionModificationBean.hourStart}"
													   partialSubmit="true"
													   valueChangeListener="#{alertDefinitionModificationBean.onChangeHourStart}">
										<f:selectItems value="#{alertDefinitionModificationBean.hourItems}"/>
									</ice:selectOneMenu>
									<ice:outputLabel value="h"/>
									<!-- <ice:inputText value="#{alertDefinitionModificationBean.minStart}" style="width: 30px;"/> -->
									<ice:selectOneMenu value="#{alertDefinitionModificationBean.minStart}"
													   partialSubmit="true"
													   valueChangeListener="#{alertDefinitionModificationBean.onChangeMinStart}">
										<f:selectItems value="#{alertDefinitionModificationBean.minItems}"/>
									</ice:selectOneMenu>
									<ice:outputLabel value="m"/>
								</ice:panelGrid>
								<ice:panelGrid columns="5">
					        		<ice:outputLabel value="End: " style="font-size: 10px; font-weight: bold"/>
									<!-- <ice:inputText value="#{alertDefinitionModificationBean.hourEnd}"
												   style="margin-left:6px; width: 30px;"/> -->
									<ice:selectOneMenu value="#{alertDefinitionModificationBean.hourEnd}"
													   partialSubmit="true" style="margin-left: 6px;"
													   valueChangeListener="#{alertDefinitionModificationBean.onChangeHourEnd}">
										<f:selectItems value="#{alertDefinitionModificationBean.hourItems}"/>
									</ice:selectOneMenu>
									<ice:outputLabel value="h"/>
									<!-- <ice:inputText value="#{alertDefinitionModificationBean.minEnd}" style="width: 30px;"/> -->
									<ice:selectOneMenu value="#{alertDefinitionModificationBean.minEnd}"
													   partialSubmit="true"
													   valueChangeListener="#{alertDefinitionModificationBean.onChangeMinEnd}">
										<f:selectItems value="#{alertDefinitionModificationBean.minItems}"/>
									</ice:selectOneMenu>
									<ice:outputLabel value="m"/>
								</ice:panelGrid>
								<ice:commandButton 	image="/images/IndiKtor2.0/Buttons/addSmall.png"
												title="Add new alert validity" 
												actionListener="#{alertDefinitionModificationBean.addAlertValidity}"
												style="margin-right: 5px; float: right;"/>
								<BR/><BR/>
								<ice:outputLabel rendered="#{alertDefinitionModificationBean.validitySize==0}"
									 			 value="Enter start time and end time."/>
								<BR/>
								<ice:outputLabel rendered="#{alertDefinitionModificationBean.validitySize==0}"
									 			 value="Then, click on the (+) button."/>
								
								<ice:outputLabel rendered="#{alertDefinitionModificationBean.validitySize!=0}"
									 			 value=""/>
								<BR/>
								<ice:outputLabel rendered="#{alertDefinitionModificationBean.validitySize!=0}"
									 			 value=""/>
							</ice:panelGroup>
							<ice:panelGroup style="padding-left: 25px;">
								<ice:outputLabel rendered="#{alertDefinitionModificationBean.validitySize==0}"
									 			 value="Alert Definition is always valid" style="font-size: 11px; padding-left: 70px;"/>
				   	  			<ice:dataTable id="alertValidities"
				   	  						   value="#{alertDefinitionModificationBean.validities}"
				               				   var="validity"
				               				   cellpadding="0"
				               				   rendered="#{alertDefinitionModificationBean.validitySize!=0}"
				               				   scrollable="true"
				               				   scrollHeight="90px"
				               				   columnWidths="130,130,20">
				               		<ice:column style="font-size: 10px; text-align: center;">						      
					        			<f:facet name="header">
					             			<ice:outputText value="Start"/>
					         			</f:facet>
					             			<ice:outputText value="#{validity.startStr}"/>
					        		</ice:column>
					        		<ice:column style="font-size: 10px; text-align: center;">
					        			<f:facet name="header">
					             			<ice:outputText value="End"/>
					         			</f:facet>
					             			<ice:outputText value="#{validity.endStr}"/>
					        		</ice:column>
					        		<ice:column style="text-align: center;">
				   						<f:facet name="header">
					             			<ice:commandButton panelConfirmation="removeConfirmPanel"
															   image="/images/IndiKtor2.0/Buttons/deleteSmall.png"
				           									   alt="Remove all Alert Validities from the list"
				           									   style="text-align: center;"
				           									   actionListener="#{alertDefinitionModificationBean.removeAllAlertValidity}"/>
					         			</f:facet>
				       					<ice:commandButton panelConfirmation="removeConfirmPanel"
								  						   image="/images/IndiKtor2.0/Buttons/deleteSmall.png"
				       									   alt="Remove this Alert Validity from the list"
				       									   style="text-align: center; padding-right: 2px;"
				       									   actionListener="#{alertDefinitionModificationBean.removeAlertValidity}">
									    	<f:attribute name="obj" value="#{validity}"/>
										</ice:commandButton>													
				       				</ice:column>				
					  			</ice:dataTable>
							</ice:panelGroup>
						</ice:panelGrid>
					</ice:panelGrid>
					<ice:panelGrid columns="1" style="border: 1px solid #336699; width: 300px; height: 145px;">
						<ice:panelGrid columns="3">
							<ice:outputLabel value="Alert Raising Delay:" style="padding-left: 12px"/>
							<ice:inputText value="#{alertDefinitionModificationBean.raisingDelay}" size="20"
										   title="The amount of time in second an alert must be UP before being raised"
										   style="#{alertCenterBean.delayStyle}"/>
							<ice:outputLabel value="&#160;&#160;sec"/>
							
							<ice:outputLabel value="Wrong format!"
											 style="color: red; font-size: 10px; float: right;"
	   							  			 rendered="#{alertCenterBean.delayWrongFormat}"/>
							<ice:outputLabel value="It must be an integer."
											 style="color: red; font-size: 10px;"
	   							  			 rendered="#{alertCenterBean.delayWrongFormat}"/>
							<ice:outputLabel value=""
	   							  			 rendered="#{alertCenterBean.delayWrongFormat}"/>
						</ice:panelGrid>
					</ice:panelGrid>
				</ice:panelGrid>
			</ice:panelGrid>
		</ice:panelGroup>
	</ice:panelTab>
	
	<ice:panelTab id="tab2">
		<f:facet name="label">
			<ice:outputText value="Conditions / Computations" style="#{alertCenterBean.tabCCStyle}"/>
		</f:facet>
		<ice:panelGroup scrollHeight="530px" style="width: 838px; height: 500px; vertical-align: top; text-align: center;">
			<ice:panelGrid columns="1">
				 <ice:outputLabel value="An alert must have at least one condition."
								  rendered="#{alertDefinitionModificationBean.conditionsError 
								  			  and !alertDefinitionModificationBean.listRendered}"
								  style="color: red; font-size: 10px; padding-left: 10px;"/>
				 <ice:outputLabel value="An alert must have at least one computation."
								  rendered="#{alertDefinitionModificationBean.computationsError}"
								  style="color: red; font-size: 10px; padding-left: 10px;"/>
				<ice:panelGrid columns="#{alertDefinitionModificationBean.panelGridColumns}">
					<!-- 
					<ice:panelCollapsible style="border: 1px solid #336699;">
						<f:facet name="header">
							<ice:panelGroup>
		                  		<ice:outputText value="Metric Selector"/>
		                  	</ice:panelGroup>
			          	</f:facet>
						<ui:include src="/jsp/ikrComponent/metricSelector.xhtml/>
					</ice:panelCollapsible>
					
					<BR/>
					 -->	
					<ice:panelGroup rendered="#{!alertDefinitionModificationBean.metricSelectorOn}">
						<ice:outputLabel value="Add conditions : "/>
						<ice:commandButton 	image="/images/IndiKtor2.0/Buttons/addSmall.png"
											title="Add new metrics" 
											actionListener="#{alertDefinitionModificationBean.handleMetricSelectorPanel}"
											style="padding-left: 5px;"/>
						<BR/><BR/>
					</ice:panelGroup> 	
					<ice:outputLabel value="Metric selector :" rendered="#{alertDefinitionModificationBean.metricSelectorOn}"/>
													
					<ice:outputLabel value="Conditions :"/>
					
					<ice:panelGrid columns="1" style="#{alertDefinitionModificationBean.metricSelectorPanelStyle}"
								   rendered="#{alertDefinitionModificationBean.metricSelectorOn}">
						<ice:commandButton 	image="/images/i/cal_off.gif"
											title="Close metrics panel" 
											actionListener="#{alertDefinitionModificationBean.handleMetricSelectorPanel}"
											style="float: right;"/>
						<ui:include src="/jsp/ikrComponent/metricSelector.xhtml"/>
					</ice:panelGrid>
					<ice:panelGroup style="#{alertDefinitionModificationBean.conditionsPanelStyle}"
									scrollWidth="#{alertDefinitionModificationBean.conditionsPanelScrollStyle}">
						<ice:commandButton 	image="/images/IndiKtor2.0/Buttons/expandWindowSmall.png"
											title="Expand conditions panel" 
											actionListener="#{alertDefinitionModificationBean.handleMetricSelectorPanel}"
											style="float: left; padding-left: 3px; padding-top: 2px;"
											rendered="#{alertDefinitionModificationBean.listRendered 
														and alertDefinitionModificationBean.metricSelectorOn}"/>
											
						<ice:outputLabel value="No Condition has been configured. Click on the plus icon (+) to add Conditions."
										 rendered="#{!alertDefinitionModificationBean.listRendered}"
										 style="padding-left: 10px;"/>									 
						<ice:dataTable 	var="conditionBean"
										value="#{alertDefinitionModificationBean.alertConditionBeans}"
		   								columnWidths="30, 315, 155, 180, 45"
		   								scrollable="true"
		   								scrollHeight="190px"
		   								width="800"
		   								rowClasses="conditionTable1, conditionTable2"
		   								cellspacing="0" cellpadding="0" border="0"
		   								rendered="#{alertDefinitionModificationBean.listRendered}">
							<ice:column>
								<f:facet name="header">
				   					<ice:outputText value="ID"/>
								</f:facet>
								<ice:outputText value="(C#{conditionBean.id})" />
		   					</ice:column>		
		   					<ice:column>
		       					<f:facet name="header">
		           					<ice:outputText value="Metric Description"/>
		       					</f:facet>
									<ice:outputText style="float: left;" id="linkHeader"
													value="#{conditionBean.ikrMetricLabel} (#{conditionBean.ikrCategory.label})"/>
									<!-- 
									<ice:commandButton style="float: right;"
													   actionListener="#{alertDefinitionModificationBean.openMetricDetailsPopup}"
												   	   image="/images/IndiKtor2.0/Buttons/showSmall.png">
										<f:attribute name="obj" value="#{conditionBean}"/>
									</ice:commandButton>
									 -->
		   					</ice:column>
		   					<ice:column>
		       					<f:facet name="header">
		           					<ice:outputText value="Operator"/>
		       					</f:facet>
		       					<ice:selectOneMenu value="#{conditionBean.operator}" style="width:150px; font-size: 10px;">
									<f:selectItems value="#{conditionBean.operators}"/>
								</ice:selectOneMenu>
		   					</ice:column>
		   					<ice:column>
		       					<f:facet name="header">
		           					<ice:outputText value="Condition Value"/>
		       					</f:facet>
		   						<ice:inputText value="#{conditionBean.value}" 
											   valueChangeListener="#{conditionBean.updateValue}" 
											   partialSubmit="true" style="width:100px; font-size: 10px;"/>
								<ice:selectOneMenu value="#{conditionBean.unit}" 
												   rendered="#{conditionBean.unitsRendered}"
												   valueChangeListener="#{conditionBean.updateUnit}"
												   partialSubmit="true" style="font-size: 10px;">
									<f:selectItems value="#{conditionBean.units}"/>
								</ice:selectOneMenu>
		       				</ice:column>
		   					<ice:column>
		      					<f:facet name="header">
		           					<ice:commandButton panelConfirmation="removeConfirmPanel"
								   					   image="/images/IndiKtor2.0/Buttons/deleteSmall.png"
		         									   title="Remove all conditions from the list"
		         									   value="Remove"
		         									   style="float: right; margin-right: 5px;"
													   actionListener="#{alertDefinitionModificationBean.removeAllCondition}"/>
								</f:facet>
								<ice:commandButton image="/images/IndiKtor2.0/Buttons/duplicateSmall.png"
												   title="Duplicate this condition from the list"
												   value="Duplicate"
												   actionListener="#{alertDefinitionModificationBean.duplicateCondition}">
									<f:attribute name="obj" value="#{conditionBean}"/>
								</ice:commandButton>
								<ice:commandButton panelConfirmation="removeConfirmPanel"
						   						   image="/images/IndiKtor2.0/Buttons/deleteSmall.png"
		       									   title="Remove this condition"
		       									   style="margin-left: 10px;"
												   value="Remove"
												   actionListener="#{alertDefinitionModificationBean.removeCondition}">
									<f:attribute name="obj" value="#{conditionBean}"/>
								</ice:commandButton>													
		       				</ice:column>				                				                				
						</ice:dataTable>
					</ice:panelGroup>
				</ice:panelGrid>
				
				<BR/>
				
				<ice:panelGrid columns="1">
					<ice:outputLabel value="Computations :"/>
					<ice:panelGrid columns="1" style="#{alertDefinitionModificationBean.computationsStyle}">
						<ice:dataTable 	var="alertCompute"
			    						value="#{alertDefinitionModificationBean.alertDefinition.alertComputes}"
			    						columnWidths="110px, 265px, 335px, 46px"
		   								rowClasses="conditionTable1, conditionTable2"
		   								cellspacing="0" cellpadding="0" border="0">
		   					<ice:column>
		       					<f:facet name="header">
		           					<ice:outputText value="Workflow"/>
		       					</f:facet>
		       					<ice:outputText value="#{alertCompute.workflow}" title="Computation Workflow">
									<f:converter converterId="DisplayConverter"/>
								</ice:outputText>
		   					</ice:column>		
		   					<ice:column>
		      					<f:facet name="header">
		          					<ice:outputText value="Cause"/>
		      					</f:facet>
		      					<ice:inputText value="#{alertCompute.cause}" style="width: 255px; margin-left: 5px;"
		      								   title="Enter an alert computation. Example: (C1 AND C2) OR C3"/>	
		      				</ice:column>
		  					<ice:column>
		       					<f:facet name="header">
		           					<ice:outputText value="Description"/>
		       					</f:facet>
		       					<ice:inputText value="#{alertCompute.label}" style="width: 325px; margin-left: 5px;"
		       								   title="Enter a definiton for this cause"/>
		   					</ice:column>
		   					<ice:column style="text-align: center;">
		       					<f:facet name="header">
		           					<ice:outputText value="Active"/>
		       					</f:facet>
								<ice:selectBooleanCheckbox value="#{alertCompute.enable}"/>
		   					</ice:column>
						</ice:dataTable>
					</ice:panelGrid>
				</ice:panelGrid>
			</ice:panelGrid>
		</ice:panelGroup>
	</ice:panelTab>
	
	<ice:panelTab id="tab3">
		<f:facet name="label">
			<ice:outputText value="Notification" style="font-size: 10px;"/>
		</f:facet>
		<ice:panelGroup scrollHeight="530px" style="width: 838px; height: 500px; vertical-align: top; text-align: center;">
			<ice:panelGrid columns="1">
				<ice:panelGrid columns="6" style="padding-bottom: 10px;">
					<ice:outputLabel value="SMS" />
				 	<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.alertUserActionBean.sms}"
				 							   partialSubmit="true" style="margin-right: 25px;"/>
				 	<ice:outputLabel value="MAIL" />
				 	<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.alertUserActionBean.mail}"
				 							   partialSubmit="true" style="margin-right: 25px;"/>
					<ice:outputLabel value="SNMP" />
					<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.alertSnmpActionBean.snmp}"
				 							   partialSubmit="true" style="margin-right: 25px;"/>
				</ice:panelGrid>
				
				<ice:outputLabel value="Alert Workflow Filter"/>	
				
				<ice:panelGrid columns="12">
					<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.lowWfw}" partialSubmit="true"/>
					<ice:outputText value="LOW" style="font-size: 10px;"/>							
					<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.mediumWfw}" partialSubmit="true"/>								
					<ice:outputText value="MEDIUM" style="font-size: 10px;"/>	
					<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.highWfw}" partialSubmit="true"/>
					<ice:outputText value="HIGH" style="font-size: 10px;"/>	
					<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.notRunningWfw}" partialSubmit="true"/>
					<ice:outputText value="NOT_RUNNING" style="font-size: 10px;"/>	
					<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.autoDownWfw}" partialSubmit="true"/>
					<ice:outputText value="AUTO_DOWN" style="font-size: 10px;"/>
					<ice:selectBooleanCheckbox value="#{alertDefinitionModificationBean.userAckWfw}" partialSubmit="true"/>
					<ice:outputText value="USER_ACK" style="font-size: 10px;"/>
				</ice:panelGrid>
				
				<HR/>
				
				<ice:panelGrid columns="1" style="width: 795px; height: 190px;">
					<ui:include src="/jsp/alert/config/userAlertActions.xhtml"/>
				</ice:panelGrid>
				
				<ice:panelGrid columns="1" style="width: 795px; height: 190px;">
					<ui:include src="/jsp/alert/config/snmpAlertActions.xhtml"/>
				</ice:panelGrid>				
			</ice:panelGrid>
		</ice:panelGroup>
	</ice:panelTab>
</ice:panelTabSet>
</f:subview>